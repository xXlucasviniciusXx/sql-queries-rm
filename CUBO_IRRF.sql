SELECT  distinct
    PFUNC.CHAPA,
    PFUNC.NOME,
    PFUNC.SALARIO,    
   CASE
        WHEN PFUNC.SALARIO <= 2112.00 THEN 0
        WHEN PFUNC.SALARIO > 2112.00 AND PFUNC.SALARIO <= 2826.65 THEN 
            CAST(((PFUNC.SALARIO * 0.075) - 158.40) AS DECIMAL(10,2))
        WHEN PFUNC.SALARIO > 2826.65 AND PFUNC.SALARIO <= 3751.05 THEN 
            CAST(((PFUNC.SALARIO * 0.15) - 370.40) AS DECIMAL(10,2))
        WHEN PFUNC.SALARIO > 3751.05 AND PFUNC.SALARIO <= 4664.68 THEN 
            CAST(((PFUNC.SALARIO * 0.225) - 651.73) AS DECIMAL(10,2))
        ELSE 
            CAST(((PFUNC.SALARIO * 0.275) - 884.96) AS DECIMAL(10,2))
    END AS IRRF_SOBRE_SALARIO
FROM 
    PFUNC (NOLOCK)
WHERE 
    PFUNC.CODSITUACAO <> 'D'
    AND PFUNC.CODCOLIGADA = :CODCOLIGADA       
ORDER BY
	PFUNC.NOME,
    PFUNC.CHAPA;
